{{> header}}

<section class="container mt-5">
  <div class="row">
    <div class="col-md-10 offset-md-1">
      <h1 class="display-4 text-center">Admin Dashboard</h1>

      <table class="table">
        <thead>
          <tr>
            <th>Booking ID</th>
            <th>Booking Date</th>
            <th>Service Option</th>
            <th>Special Requests</th>
            <th>Phone Number</th>
            <th>Email</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {{#each bookings}}
            {{#with this}}
              <tr>
                <td>{{bookingId}}</td>
                <td>{{bookingDate}}</td>
                <td>{{serviceOption}}</td>
                <td>{{specialRequests}}</td>
                <td>{{phoneNumber}}</td>
                <td>{{email}}</td>
                <td>
                  <button onclick="confirmDelete('{{bookingId}}')" class="btn btn-danger">Delete</button>
                </td>
              </tr>
            {{/with}}
          {{/each}}
        </tbody>
      </table>
    </div>
  </div>
</section>

<script>
  // Function to handle the delete confirmation
  function confirmDelete(bookingId) {
    const confirmed = confirm("Are you sure you want to delete this booking?");
    if (confirmed) {
      deleteBooking(bookingId);
    }
  }

  // Function to handle the delete operation
  function deleteBooking(bookingId) {
    // Use AJAX or fetch to send a request to the server to handle the deletion
    // You can use the /delete-booking route on the server to delete the booking
    // Reload the page or update the UI after successful deletion

    // Example using fetch:
    fetch(`/delete-booking/${bookingId}`, {
      method: 'DELETE',
    })
    .then(response => {
      if (response.ok) {
        console.log('Booking deleted successfully');
        // Reload the page or update the UI after successful deletion
        location.reload();
      } else {
        console.error('Error deleting booking:', response.statusText);
      }
    })
    .catch(error => {
      console.error('Error deleting booking:', error);
    });
  }
</script>
